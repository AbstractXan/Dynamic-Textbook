Same query implementation for data retrieval
https://data.stackexchange.com/stackoverflow/query/edit/899358